package com.snk.fundamentus;

import javax.xml.parsers.ParserConfigurationException;
import javax.xml.xpath.XPath;
import javax.xml.xpath.XPathConstants;
import javax.xml.xpath.XPathExpressionException;
import javax.xml.xpath.XPathFactory;

import org.htmlcleaner.CleanerProperties;
import org.htmlcleaner.DomSerializer;
import org.htmlcleaner.HtmlCleaner;
import org.htmlcleaner.TagNode;


public class RegExClasses {
	private final static String NAME  = "/html/body/div[1]/div[2]/table[1]/tbody/tr[1]/td[2]/span";
	private final static String TIPO  = "/html/body/div[1]/div[2]/table[1]/tbody/tr[2]/td[2]/span";
	private final static String NOME_EMPRESA  = "/html/body/div[1]/div[2]/table[1]/tbody/tr[3]/td[2]/span";
	private final static String SETOR  = "/html/body/div[1]/div[2]/table[1]/tbody/tr[4]/td[2]/span/a";
	private final static String SUB_SETOR  = "/html/body/div[1]/div[2]/table[1]/tbody/tr[5]/td[2]/span/a";
	private final static String COTACAO  = "/html/body/div[1]/div[2]/table[1]/tbody/tr[1]/td[4]/span";
	private final static String DATA_ULTIMA_COTACAO  = "/html/body/div[1]/div[2]/table[1]/tbody/tr[2]/td[4]/span";
	private final static String MIN_52_SEMANAS  = "/html/body/div[1]/div[2]/table[1]/tbody/tr[3]/td[4]/span";
	private final static String MAX_52_SEMANAS  = "/html/body/div[1]/div[2]/table[1]/tbody/tr[4]/td[4]/span";
	private final static String VOLUME_MEDIO_ULTIMOS_2_MESES  = "/html/body/div[1]/div[2]/table[1]/tbody/tr[5]/td[4]/span";
	private final static String ULTIMO_BALANCO_PROCESSADO  = "/html/body/div[1]/div[2]/table[2]/tbody/tr[1]/td[4]/span";
	private final static String NUMERO_ACOES  = "/html/body/div[1]/div[2]/table[2]/tbody/tr[2]/td[4]/span";
	private final static String VALOR_DE_MERCADO  = "/html/body/div[1]/div[2]/table[2]/tbody/tr[1]/td[2]/span";
	private final static String VALOR_EMPRESA  = "/html/body/div[1]/div[2]/table[2]/tbody/tr[2]/td[2]/span";
	private final static String allStr = "<html lang=\"pt-br\"><head>	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\"><title>FUNDAMENTUS - VALE3 - Invista consciente - Indicadores Fundamentalistas</title>		<link rel=\"stylesheet\" href=\"css/estilo.css\" type=\"text/css\" media=\"screen, projection\">	<link rel=\"stylesheet\" href=\"css/print.css\" type=\"text/css\" media=\"print\">	<link rel=\"shortcut icon\" href=\"img/fundamentus.ico\" type=\"image/x-icon\">	<!--[if lte IE 6]>		<link rel=\"stylesheet\" type=\"text/css\" href=\"css/menu_ie6.css\">		<script type=\"text/javascript\" src=\"script/ADxMenu.js\"></script>	<![endif]-->	<style type=\"text/css\"></style><script src=\"script/mootools.svn.js\" type=\"text/javascript\"></script>	<script type=\"text/javascript\" src=\"script/Observer.js\"></script>	<script type=\"text/javascript\" src=\"script/Autocompleter.js\"></script>	<script src=\"script/cmplte.php\" type=\"text/javascript\" language=\"JavaScript\"></script>		<script src=\"script/tip.js\" type=\"text/javascript\" language=\"JavaScript\"></script>	<script type=\"text/javascript\">		function poApple() { }	</script>		</head><body class=\"detalhes\">	<!-- ClickTale Top part --><script type=\"text/javascript\">var WRInitTime=(new Date()).getTime();</script><!-- ClickTale end of Top part -->		<div class=\"center\">			<div class=\"topo\">		<a href=\"index.php\"><img class=\"logo\" src=\"img/logo.gif\" alt=\"FUNDAMENTUS - Invista consciente\"></a>			<div class=\"avancada\"><a href=\"buscaavancada.php\">Busca avançada por empresa</a></div>			<form class=\"busca\" method=\"get\" action=\"detalhes.php\">				<fieldset>					<legend>Procurar por ação/empresa</legend>					<input class=\"texto\" autocomplete=\"off\" id=\"completar\" name=\"papel\" type=\"text\"><input type=\"image\" src=\"img/bt_exibir.jpg\" class=\"botao\" value=\"Exibir\"><br>				</fieldset>			</form>      <div class=\"atual\"><p>Você está vendo<strong>VALE3</strong></p></div>			<div id=\"containerMenu\">				<ul id=\"menu\" class=\"institucional adxm menu\">					<li><a class=\"home\" href=\"index.php\">Página inicial</a></li>					<!--- <li><a class=\"conheca\" href=\"conheca.php\">Conheça o sistema</a></li> --->					<li><a class=\"consciente\" href=\"consciente.php\">Investimento consciente</a></li>					<li><a class=\"contato\" href=\"contato.php\">Entre em contato</a></li>          				</ul>				<ul id=\"menu\" class=\"software adxm menu\">					<li><a class=\"detalhes\" href=\"detalhes.php\">Detalhes</a></li>					<li><a class=\"graficos\" onclick=\"poApple()\">Gráficos</a>						<ul>							<li><a href=\"graficos.php?papel=VALE3&amp;tipo=1\">Balanço patrimonial</a></li>							<li><a href=\"graficos.php?papel=VALE3&amp;tipo=2\">Demonstrativos de resultados</a></li>							<li><a href=\"graficos.php?papel=VALE3&amp;tipo=3\">Indicadores fundamentalistas</a></li>						</ul>					</li>					<li><a class=\"historicos\" onclick=\"poApple()\">Dados Históricos</a>						<ul class=\"provetos\">							<li><a class=\"dh\" href=\"balancos.php?papel=VALE3&amp;tipo=1\">Balanços em Excel</a></li>							<li><a class=\"dh\" href=\"proventos.php?papel=VALE3&amp;tipo=2\">Proventos</a></li>						</ul>					</li>					<li><a class=\"cotacoes\" href=\"cotacoes.php?papel=VALE3\">Histórico de cotações</a></li>									</ul>			</div>		</div>		<div class=\"conteudo clearfix\">  <div style=\"float: right; width: 180px;\"><script type=\"text/javascript\"><!--google_ad_client = \"ca-pub-3119085269630402\";/* anuncioVerticalDireita */google_ad_slot = \"8411733769\";google_ad_width = 160;google_ad_height = 600;//--></script><script type=\"text/javascript\" src=\"http://pagead2.googlesyndication.com/pagead/show_ads.js\"></script></div>			<table class=\"w728\">				<tbody><tr>					<td class=\"label w15\"><span class=\"help tips\">?</span><span class=\"txt\">Papel</span></td>					<td class=\"data w35\"><span class=\"txt\">VALE3</span></td>					<td class=\"label destaque w2\"><span class=\"help tips\">?</span><span class=\"txt\">Cotação</span></td>					<td class=\"data destaque w3\"><span class=\"txt\">19,15</span></td>				</tr>				<tr>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Tipo</span></td>					<td class=\"data\"><span class=\"txt\">ON N1</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Data últ cot</span></td>					<td class=\"data\"><span class=\"txt\">19/03/2015</span></td>				</tr>				<tr>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Empresa</span></td>					<td class=\"data\"><span class=\"txt\">CVRD ON N1</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Min 52 sem</span></td>					<td class=\"data\"><span class=\"txt\">18,05</span></td>				</tr>				<tr>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Setor</span></td>					<td class=\"data\"><span class=\"txt\"><a href=\"resultado.php?setor=2\">Mineração</a></span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Max 52 sem</span></td>					<td class=\"data\"><span class=\"txt\">31,84</span></td>				</tr>				<tr>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Subsetor</span></td>					<td class=\"data\"><span class=\"txt\"><a href=\"resultado.php?segmento=3\">Minerais Metálicos</a></span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Vol $ méd (2m)</span></td>					<td class=\"data\"><span class=\"txt\">124.546.000</span></td>				</tr>			</tbody></table>			<table class=\"w728\">				<tbody><tr>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">Valor de mercado</span></td>					<td class=\"data w3\"><span class=\"txt\">100.429.000.000</span></td>					<td class=\"label w3\"><span class=\"help tips\">?</span><span class=\"txt\">Últ balanço processado</span></td>					<td class=\"data w2\"><span class=\"txt\">31/12/2014</span></td>				</tr>				<tr>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">Valor da firma</span></td>					<td class=\"data w3\"><span class=\"txt\">166.391.000.000</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Nro. Ações</span></td>					<td class=\"data\"><span class=\"txt\">5.244.320.000</span></td>				</tr>			</tbody></table>			<table class=\"w728\">				<tbody><tr>					<td class=\"nivel1\" colspan=\"2\"><span class=\"txt\">Oscilações</span></td>					<td class=\"nivel1\" colspan=\"4\"><span class=\"txt\">Indicadores fundamentalistas</span></td>				</tr>				<tr>					<td class=\"label w1\"><span class=\"txt\">Dia</span></td>					<td class=\"data w1\"><span class=\"oscil\"><font color=\"#F75D59\">-2,25%</font></span></td>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">P/L</span></td>					<td class=\"data w2\"><span class=\"txt\">105,23</span></td>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">LPA</span></td>					<td class=\"data w2\"><span class=\"txt\">0,18</span></td>				</tr>				<tr>					<td class=\"label w1\"><span class=\"txt\">Mês</span></td>					<td class=\"data w1\"><span class=\"oscil\"><font color=\"#F75D59\">-9,88%</font></span></td>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">P/VP</span></td>					<td class=\"data w2\"><span class=\"txt\">0,69</span></td>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">VPA</span></td>					<td class=\"data w2\"><span class=\"txt\">27,92</span></td>				</tr>				<tr>					<td class=\"label w1\"><span class=\"txt\">30 dias</span></td>					<td class=\"data w1\"><span class=\"oscil\"><font color=\"#F75D59\">-15,68%</font></span></td>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">P/EBIT</span></td>					<td class=\"data w2\"><span class=\"txt\">          3,78</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Marg. Bruta</span></td>					<td class=\"data\"><span class=\"txt\">          33,1%</span></td>				</tr>				<tr>					<td class=\"label w1\"><span class=\"txt\">12 meses</span></td>					<td class=\"data w1\"><span class=\"oscil\"><font color=\"#F75D59\">-31,70%</font></span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">PSR</span></td>					<td class=\"data\"><span class=\"txt\">          1,14</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Marg. EBIT</span></td>					<td class=\"data\"><span class=\"txt\">          30,1%</span></td>				</tr>				<tr>					<td class=\"label w1\"><span class=\"txt\">2015</span></td>					<td class=\"data w1\"><span class=\"oscil\"><font color=\"#F75D59\">-12,60%</font></span></td>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">P/Ativos</span></td>					<td class=\"data w2\"><span class=\"txt\">          0,32</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Marg. Líquida</span></td>					<td class=\"data\"><span class=\"txt\">          0,2%</span></td>				</tr>				<tr>					<td class=\"label w1\"><span class=\"txt\">2014</span></td>					<td class=\"data w1\"><span class=\"oscil\"><font color=\"#F75D59\">-34,77%</font></span></td>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">P/Cap. Giro</span></td>					<td class=\"data w2\"><span class=\"txt\">          3,98</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">EBIT / Ativo</span></td>					<td class=\"data\"><span class=\"txt\">8,6%</span></td>				</tr>				<tr>					<td class=\"label w1\"><span class=\"txt\">2013</span></td>					<td class=\"data w1\"><span class=\"oscil\"><font color=\"#F75D59\">-10,90%</font></span></td>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">P/Ativ Circ Liq</span></td>					<td class=\"data w2\"><span class=\"txt\">          -0,95</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">ROIC</span></td>					<td class=\"data\"><span class=\"txt\">          9,3%</span></td>				</tr>				<tr>					<td class=\"label w1\"><span class=\"txt\">2012</span></td>					<td class=\"data w1\"><span class=\"oscil\"><font color=\"#306EFF\">13,42%</font></span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Div. Yield</span></td>					<td class=\"data\"><span class=\"txt\">10,0%</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">ROE</span></td>					<td class=\"data\"><span class=\"txt\">          0,7%</span></td>				</tr>				<tr>					<td class=\"label w1\"><span class=\"txt\">2011</span></td>					<td class=\"data w1\"><span class=\"oscil\"><font color=\"#F75D59\">-24,11%</font></span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">EV / EBIT</span></td>					<td class=\"data\"><span class=\"txt\">          6,26</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Liquidez Corr</span></td>					<td class=\"data\"><span class=\"txt\">          1,88</span></td>				</tr>				<tr>					<td class=\"label w1\"><span class=\"txt\">2010</span></td>					<td class=\"data w1\"><span class=\"oscil\"><font color=\"#306EFF\">9,47%</font></span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Giro Ativos</span></td>					<td class=\"data\"><span class=\"txt\">          0,29</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Div Br/ Patrim</span></td>					<td class=\"data\"><span class=\"txt\">          0,52</span></td>				</tr>				<tr>					<td class=\"label w1\"><span class=\"txt\"></span></td>					<td class=\"data w1\"><span class=\"oscil\"></span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Cres. Rec (5a)</span></td>					<td class=\"data\"><span class=\"txt\">          1,0%</span></td>					<td class=\"label\"><span class=\"txt\"></span></td>					<td class=\"data\"><span class=\"txt\"></span></td>				</tr>			</tbody></table>			<table class=\"w728\">				<tbody><tr>					<td class=\"nivel1\" colspan=\"4\"><span class=\"txt\">Dados Balanço Patrimonial</span></td>				</tr>				<tr>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">Ativo</span></td>					<td class=\"data w3\"><span class=\"txt\">309.416.000.000</span></td>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">Dív. Bruta</span></td>					<td class=\"data w3\"><span class=\"txt\">76.517.300.000</span></td>				</tr>				<tr>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Disponibilidades</span></td>					<td class=\"data\"><span class=\"txt\">10.555.300.000</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Dív. Líquida</span></td>					<td class=\"data\"><span class=\"txt\">65.962.000.000</span></td>				</tr>				<tr>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Ativo Circulante</span></td>					<td class=\"data\"><span class=\"txt\">53.744.800.000</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Patrim. Líq</span></td>					<td class=\"data\"><span class=\"txt\">146.415.000.000</span></td>				</tr>			</tbody></table>			<table class=\"w728\">				<tbody><tr>					<td class=\"nivel1\" colspan=\"4\"><span class=\"txt\">Dados demonstrativos de resultados</span></td>				</tr>				<tr>					<td class=\"nivel2 w5\" colspan=\"2\"><span class=\"txt\">Últimos 12 meses</span></td>					<td class=\"nivel2 w5\" colspan=\"2\"><span class=\"txt\">Últimos 3 meses</span></td>				</tr>				<tr>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">Receita Líquida</span></td>					<td class=\"data w3\"><span class=\"txt\">88.274.600.000</span></td>					<td class=\"label w2\"><span class=\"help tips\">?</span><span class=\"txt\">Receita Líquida</span></td>					<td class=\"data w3\"><span class=\"txt\">23.151.800.000</span></td>				</tr>				<tr>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">EBIT</span></td>					<td class=\"data\"><span class=\"txt\">26.585.200.000</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">EBIT</span></td>					<td class=\"data\"><span class=\"txt\">4.825.530.000</span></td>				</tr>				<tr>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Lucro Líquido</span></td>					<td class=\"data\"><span class=\"txt\">954.384.000</span></td>					<td class=\"label\"><span class=\"help tips\">?</span><span class=\"txt\">Lucro Líquido</span></td>					<td class=\"data\"><span class=\"txt\">-4.760.430.000</span></td>				</tr>			</tbody></table>			<br><script type=\"text/javascript\"><!--google_ad_client = \"ca-pub-3119085269630402\";/* anuncioRodape */google_ad_slot = \"1513786315\";google_ad_width = 728;google_ad_height = 90;//--></script><script type=\"text/javascript\" src=\"http://pagead2.googlesyndication.com/pagead/show_ads.js\"></script>		</div>	</div>		<div class=\"rodape\">		<div class=\"center\">			<ul>				<li><strong>Menu institucional:</strong></li>				<li><a class=\"home\" href=\"index.php\">Página inicial</a>|</li>				<li><a class=\"conheca\" href=\"conheca.php\">Conheça o site</a>|</li>				<li><a class=\"consciente\" href=\"consciente.php\">Investimento Consciente</a>|</li>				<li><a class=\"contato\" href=\"contato.php\">Entre em contato</a>|</li>			<!---	<li><a class=\"assine\" href=\"assine.php\">Assine agora</a></li> --->			</ul>			<ul>				<li><strong>Menu software: </strong></li>				<li><a class=\"graficos\" href=\"graficos.php?tipo=1\">Gráficos</a>|</li>				<li><a class=\"detalhes\" href=\"detalhes.php\">Detalhes</a>|</li>				<li><a class=\"cotacoes\" href=\"cotacoes.php\">Histórico de cotações</a>|</li>				<li><a class=\"proventos\" href=\"proventos.php\">Proventos</a>|</li>				<li><a class=\"historicos\" href=\"balancos.php\">Balanços Históricos</a></li>			</ul>		</div>	</div>	<script type=\"text/javascript\">    var gaJsHost = ((\"https:\" == document.location.protocol) ? \"https://ssl.\" : \"http://www.\");    document.write(unescape(\"%3Cscript src='\" + gaJsHost + \"google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E\"));    </script><script src=\"http://www.google-analytics.com/ga.js\" type=\"text/javascript\"></script>    <script type=\"text/javascript\">    var pageTracker = _gat._getTracker(\"UA-3584125-1\");    pageTracker._initData();    pageTracker._trackPageview();  </script>  <!-- ClickTale Bottom part -->  <div id=\"ClickTale\" style=\"display: none;\"></div>  <script src=\"http://s.clicktale.net/WRa.js\" type=\"text/javascript\"></script>  <script type=\"text/javascript\">  if(typeof ClickTale=='function') ClickTale(12450,0.25);  </script>  <!-- ClickTale end of Bottom part --><ul class=\"autocompleter-choices\" style=\"z-index: 42; visibility: hidden; zoom: 1; opacity: 0;\"></ul><div class=\"dica-tip\" style=\"position: absolute; top: 393px; left: 761px; visibility: hidden;\"><div><div class=\"dica-text\"><span>Preço da ação dividido pelos Ativos Circulantes Líquidos por ação. Ativo Circ. Líq. é obtido subtraindo os ativos circulantes pelas dívidas de curto e longo prazo, ou seja, após o pagamento de todas as dívidas, quanto sobraria dos ativos mais líquidos da empresa (caixa, estoque, etc)</span></div></div></div></body></html>";
	
	public static void main(String[] args ) throws ParserConfigurationException, XPathExpressionException{
		System.out.println(getFieldFromXpath(allStr, NAME));
		System.out.println(getFieldFromXpath(allStr, TIPO));
		System.out.println(getFieldFromXpath(allStr, NOME_EMPRESA));
		System.out.println(getFieldFromXpath(allStr, SETOR));
		System.out.println(getFieldFromXpath(allStr, SUB_SETOR));
		System.out.println(getFieldFromXpath(allStr, COTACAO));
		System.out.println(getFieldFromXpath(allStr, DATA_ULTIMA_COTACAO));
		System.out.println(getFieldFromXpath(allStr, MIN_52_SEMANAS));
		System.out.println(getFieldFromXpath(allStr, MAX_52_SEMANAS));
		System.out.println(getFieldFromXpath(allStr, VOLUME_MEDIO_ULTIMOS_2_MESES));
		System.out.println(getFieldFromXpath(allStr, ULTIMO_BALANCO_PROCESSADO));
		System.out.println(getFieldFromXpath(allStr, NUMERO_ACOES));
		System.out.println(getFieldFromXpath(allStr, VALOR_DE_MERCADO));
		System.out.println(getFieldFromXpath(allStr, VALOR_EMPRESA));
	}

	private static String getFieldFromXpath(String html, String x)
			throws ParserConfigurationException, XPathExpressionException {
		TagNode tagNode = new HtmlCleaner().clean(html);
		org.w3c.dom.Document doc = new DomSerializer(new CleanerProperties()).createDOM(tagNode);
		
		
		XPath xpath = XPathFactory.newInstance().newXPath();
		String str = (String) xpath.evaluate(x, doc, XPathConstants.STRING);
		
		return str;
	}
}
